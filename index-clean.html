<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社交媒体发布日历</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Work Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8f9fa;
        }
        .calendar-cell {
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }
        .calendar-cell:hover {
            border-color: #d1d5db;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .today-cell {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-color: #10b981;
        }
        .past-cell {
            background: #f9fafb;
            color: #6b7280;
        }
        .aspect-9-16 {
            aspect-ratio: 9 / 16;
        }
    </style>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // 简单图标组件
        const ChevronLeft = () => <span style={{fontSize: '24px'}}>‹</span>;
        const ChevronRight = () => <span style={{fontSize: '24px'}}>›</span>;
        const PlusCircle = () => <span>+</span>;
        const XCircle = () => <span>×</span>;

        const App = () => {
            const [currentDate, setCurrentDate] = React.useState(new Date());
            const [scheduledPosts, setScheduledPosts] = React.useState(() => {
                try {
                    const saved = localStorage.getItem('socialMediaCalendar');
                    return saved ? JSON.parse(saved) : {};
                } catch (error) {
                    console.error('加载数据失败:', error);
                    return {};
                }
            });
            const [showModal, setShowModal] = React.useState(false);
            const [selectedDay, setSelectedDay] = React.useState(null);
            const [selectedFiles, setSelectedFiles] = React.useState([]);
            const [selectedPlatforms, setSelectedPlatforms] = React.useState([]);
            const [captionInput, setCaptionInput] = React.useState('');
            const [message, setMessage] = React.useState({ text: '', type: '' });
            const [lightboxMedia, setLightboxMedia] = React.useState(null);
            const [currentLightboxIndex, setCurrentLightboxIndex] = React.useState(0);
            const [carouselIndices, setCarouselIndices] = React.useState({});

            const platforms = [
                { name: 'IG', url: 'https://www.instagram.com/' },
                { name: 'FB', url: 'https://www.facebook.com/' },
                { name: '小红书', url: 'https://www.xiaohongshu.com/' },
                { name: '抖音', url: 'https://www.douyin.com/' },
                { name: '微博', url: 'https://weibo.com/' },
                { name: '微信', url: 'https://mp.weixin.qq.com/' }
            ];

            // 保存到localStorage
            React.useEffect(() => {
                try {
                    localStorage.setItem('socialMediaCalendar', JSON.stringify(scheduledPosts));
                } catch (error) {
                    console.error('保存数据失败:', error);
                }
            }, [scheduledPosts]);

            // 轮播逻辑
            React.useEffect(() => {
                const intervals = {};
                Object.keys(scheduledPosts).forEach(dayKey => {
                    const posts = scheduledPosts[dayKey];
                    if (posts.length > 0 && posts[0].files && posts[0].files.length > 1) {
                        intervals[dayKey] = setInterval(() => {
                            setCarouselIndices(prev => {
                                const newIndex = ((prev[dayKey] || 0) + 1) % posts[0].files.length;
                                return { ...prev, [dayKey]: newIndex };
                            });
                        }, 5000);
                    }
                });
                return () => { 
                    Object.values(intervals).forEach(interval => clearInterval(interval)); 
                };
            }, [scheduledPosts]);

            // 键盘事件
            React.useEffect(() => {
                const handleKeyDown = (event) => {
                    if (event.key === 'Escape' && lightboxMedia) {
                        closeLightbox();
                    }
                };
                document.addEventListener('keydown', handleKeyDown);
                return () => document.removeEventListener('keydown', handleKeyDown);
            }, [lightboxMedia]);

            const showTemporaryMessage = (text, type = 'success') => {
                setMessage({ text, type });
                setTimeout(() => setMessage({ text: '', type: '' }), 3000);
            };

            const getToday = () => {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                return today;
            };

            const getDaysInMonth = (date) => {
                return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
            };

            const getFirstDayOfMonth = (date) => {
                return new Date(date.getFullYear(), date.getMonth(), 1).getDay();
            };

            const prevMonth = () => {
                setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1));
            };

            const nextMonth = () => {
                setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1));
            };

            const openModal = (day) => {
                setSelectedDay(day);
                setSelectedFiles([]);
                setSelectedPlatforms([]);
                setCaptionInput('');
                setShowModal(true);
            };

            const closeModal = () => {
                setShowModal(false);
                setSelectedDay(null);
                setSelectedFiles([]);
                setSelectedPlatforms([]);
                setCaptionInput('');
            };

            const handleFileChange = (event) => {
                const files = Array.from(event.target.files);
                setSelectedFiles(files);
            };

            const removeSelectedFile = (index) => {
                setSelectedFiles(selectedFiles.filter((_, i) => i !== index));
            };

            const togglePlatform = (platform) => {
                setSelectedPlatforms(prev => 
                    prev.includes(platform) 
                        ? prev.filter(p => p !== platform)
                        : [...prev, platform]
                );
            };

            const addMediaToDay = () => {
                if (selectedFiles.length === 0 && !captionInput.trim()) {
                    showTemporaryMessage('请上传图片/视频或输入文案。', 'error');
                    return;
                }
                if (selectedPlatforms.length === 0) {
                    showTemporaryMessage('请至少选择一个发布平台。', 'error');
                    return;
                }

                const dayKey = selectedDay.toISOString().split('T')[0];
                const newPost = {
                    platforms: selectedPlatforms,
                    caption: captionInput.trim(),
                    files: []
                };

                if (selectedFiles.length > 0) {
                    const filePromises = selectedFiles.map(file => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                resolve({
                                    type: file.type.startsWith('image/') ? 'image' : 'video',
                                    dataUrl: e.target.result,
                                    originalDataUrl: e.target.result, // 同样的数据用于lightbox
                                    name: file.name,
                                    size: file.size
                                });
                            };
                            reader.onerror = reject;
                            reader.readAsDataURL(file);
                        });
                    });

                    Promise.all(filePromises)
                        .then(fileData => {
                            newPost.files = fileData;
                            setScheduledPosts(prevPosts => {
                                const updatedPosts = { ...prevPosts };
                                if (!updatedPosts[dayKey]) {
                                    updatedPosts[dayKey] = [];
                                }
                                updatedPosts[dayKey].push(newPost);
                                return updatedPosts;
                            });
                            closeModal();
                            showTemporaryMessage('内容已添加到日历！', 'success');
                        })
                        .catch(() => {
                            showTemporaryMessage('文件读取失败。', 'error');
                        });
                } else {
                    setScheduledPosts(prevPosts => {
                        const updatedPosts = { ...prevPosts };
                        if (!updatedPosts[dayKey]) {
                            updatedPosts[dayKey] = [];
                        }
                        updatedPosts[dayKey].push(newPost);
                        return updatedPosts;
                    });
                    closeModal();
                    showTemporaryMessage('内容已添加到日历！', 'success');
                }
            };

            const removeMedia = (day, postIndex) => {
                const dayKey = day.toISOString().split('T')[0];
                setScheduledPosts(prevPosts => {
                    const updatedPosts = { ...prevPosts };
                    if (updatedPosts[dayKey]) {
                        updatedPosts[dayKey].splice(postIndex, 1);
                        if (updatedPosts[dayKey].length === 0) {
                            delete updatedPosts[dayKey];
                        }
                    }
                    return updatedPosts;
                });
                showTemporaryMessage('内容已删除。', 'error');
            };

            const openLightbox = (media) => {
                console.log('OpenLightbox called with:', media);
                setLightboxMedia(media);
                setCurrentLightboxIndex(media.currentIndex || 0);
            };

            const closeLightbox = () => {
                setLightboxMedia(null);
            };

            const renderCalendarDays = () => {
                const today = getToday();
                const daysInMonth = getDaysInMonth(currentDate);
                const firstDay = getFirstDayOfMonth(currentDate);
                const days = [];

                // 空白天数
                for (let i = 0; i < firstDay; i++) {
                    days.push(<div key={`empty-${i}`} className="aspect-9-16"></div>);
                }

                // 月份天数
                for (let day = 1; day <= daysInMonth; day++) {
                    const currentDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
                    currentDay.setHours(0, 0, 0, 0);
                    const dayKey = currentDay.toISOString().split('T')[0];
                    const postsForDay = scheduledPosts[dayKey] || [];

                    let cellClass = 'calendar-cell bg-white';
                    if (currentDay.getTime() === today.getTime()) {
                        cellClass = 'calendar-cell today-cell';
                    } else if (currentDay.getTime() < today.getTime()) {
                        cellClass = 'calendar-cell past-cell';
                    }

                    days.push(
                        <div key={dayKey} className="flex flex-col">
                            <div className={`relative ${cellClass} aspect-9-16`}>
                                <div className="absolute top-2 left-2 text-xs text-gray-400 z-10" style={{fontWeight: 300}}>{day}</div>
                                
                                {postsForDay.length > 0 ? (
                                    postsForDay[0].files && postsForDay[0].files.length > 0 ? (
                                        <div className="relative group media-container">
                                            <button
                                                onClick={() => removeMedia(currentDay, 0)}
                                                className="absolute top-2 right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity bg-blue-500 text-white rounded-full p-1 shadow-md hover:bg-blue-600"
                                                title="删除内容"
                                            >
                                                <XCircle />
                                            </button>
                                            
                                            {/* 多个文件时显示轮播指示器 */}
                                            {postsForDay[0].files.length > 1 && (
                                                <div className="absolute bottom-2 left-1/2 transform -translate-x-1/2 z-10 flex space-x-1 bg-black bg-opacity-30 px-2 py-1 rounded-full">
                                                    {postsForDay[0].files.map((_, index) => (
                                                        <div
                                                            key={index}
                                                            className={`w-1.5 h-1.5 rounded-full ${
                                                                index === (carouselIndices[dayKey] || 0) 
                                                                    ? 'bg-white' 
                                                                    : 'bg-white bg-opacity-50'
                                                            }`}
                                                        />
                                                    ))}
                                                </div>
                                            )}
                                            
                                            {(() => {
                                                const currentFileIndex = carouselIndices[dayKey] || 0;
                                                const currentFile = postsForDay[0].files[currentFileIndex];
                                                
                                                if (currentFile.type === 'image') {
                                                    return (
                                                        <img
                                                            src={currentFile.dataUrl}
                                                            alt="内容图片"
                                                            className="w-full h-full object-cover cursor-pointer"
                                                            onClick={() => openLightbox({
                                                                ...currentFile,
                                                                caption: postsForDay[0].caption,
                                                                allFiles: postsForDay[0].files,
                                                                currentIndex: currentFileIndex
                                                            })}
                                                        />
                                                    );
                                                } else {
                                                    return (
                                                        <div 
                                                            className="w-full h-full cursor-pointer"
                                                            onClick={() => openLightbox({
                                                                ...currentFile,
                                                                caption: postsForDay[0].caption,
                                                                allFiles: postsForDay[0].files,
                                                                currentIndex: currentFileIndex
                                                            })}
                                                        >
                                                            {currentFile.dataUrl ? (
                                                                <video
                                                                    src={currentFile.dataUrl}
                                                                    className="w-full h-full object-cover"
                                                                    autoPlay
                                                                    muted
                                                                    loop
                                                                    playsInline
                                                                    onClick={(e) => e.stopPropagation()}
                                                                />
                                                            ) : (
                                                                <div className="w-full h-full bg-gray-200 flex items-center justify-center">
                                                                    <span className="text-4xl">🎥</span>
                                                                </div>
                                                            )}
                                                        </div>
                                                    );
                                                }
                                            })()}
                                        </div>
                                    ) : (
                                        postsForDay[0].caption && (
                                            <div className="relative group w-full h-full">
                                                <button
                                                    onClick={() => removeMedia(currentDay, 0)}
                                                    className="absolute top-2 right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity bg-blue-500 text-white rounded-full p-1 shadow-md hover:bg-blue-600"
                                                    title="删除内容"
                                                >
                                                    <XCircle />
                                                </button>
                                                
                                                <div 
                                                    className="w-full h-full p-3 cursor-pointer bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 hover:from-blue-100 hover:to-indigo-100 transition-colors flex items-center justify-center"
                                                    onClick={() => openLightbox({
                                                        type: 'text',
                                                        caption: postsForDay[0].caption,
                                                        platforms: postsForDay[0].platforms
                                                    })}
                                                >
                                                    <div className="text-center">
                                                        <div className="text-2xl mb-2">📝</div>
                                                        <div className="text-xs text-gray-600 line-clamp-3">
                                                            {postsForDay[0].caption}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        )
                                    )
                                ) : (
                                    <button
                                        onClick={() => openModal(currentDay)}
                                        className="w-full h-full flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-50 transition-colors"
                                    >
                                        <PlusCircle />
                                    </button>
                                )}
                                
                                {/* 添加按钮 */}
                                <div className="flex justify-center mt-1">
                                    <button
                                        onClick={() => openModal(currentDay)}
                                        className="text-xs text-gray-400 hover:text-gray-600 px-2 py-1 rounded transition-colors"
                                        style={{fontWeight: 300}}
                                    >
                                        添加内容
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }

                return days;
            };

            return (
                <div className="min-h-screen bg-gray-50 p-4 md:p-6 font-sans antialiased">
                    <div className="max-w-7xl mx-auto bg-white">
                        
                        {/* 顶部控制栏 */}
                        <div className="flex justify-between items-center p-4 md:p-8 pb-4">
                            {/* 月份导航 */}
                            <div className="flex items-center space-x-4">
                                <button
                                    onClick={prevMonth}
                                    className="p-2 rounded-full hover:bg-gray-100 transition-colors"
                                >
                                    <ChevronLeft />
                                </button>
                                <h1 className="text-2xl md:text-3xl font-light text-gray-800">
                                    {currentDate.getFullYear()}年{currentDate.getMonth() + 1}月
                                </h1>
                                <button
                                    onClick={nextMonth}
                                    className="p-2 rounded-full hover:bg-gray-100 transition-colors"
                                >
                                    <ChevronRight />
                                </button>
                            </div>
                        </div>

                        {/* 消息提示 */}
                        {message.text && (
                            <div className={`mx-4 md:mx-8 mb-4 p-3 rounded-lg ${
                                message.type === 'error' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'
                            }`}>
                                {message.text}
                            </div>
                        )}

                        {/* 星期标题 */}
                        <div className="grid grid-cols-7 gap-2 px-4 md:px-8 pb-2">
                            {['日', '一', '二', '三', '四', '五', '六'].map(day => (
                                <div key={day} className="text-center text-sm text-gray-500 font-light py-2">
                                    {day}
                                </div>
                            ))}
                        </div>

                        {/* 日历网格 */}
                        <div className="grid grid-cols-7 gap-2 p-4 md:p-8 pt-0">
                            {renderCalendarDays()}
                        </div>

                        {/* 添加内容模态框 */}
                        {showModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                                <div className="bg-white rounded-lg p-6 w-full max-w-md shadow-xl">
                                    <h3 className="text-2xl font-bold text-gray-800 mb-4 text-center">
                                        添加内容到 {selectedDay?.toLocaleDateString('zh-CN')}
                                    </h3>

                                    <div className="mb-4">
                                        <label className="block text-gray-700 text-sm font-medium mb-2">
                                            上传图片或视频 (可选)
                                        </label>
                                        <div className="flex items-center justify-center w-full">
                                            <label className="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors">
                                                <div className="flex flex-col items-center justify-center pt-5 pb-6">
                                                    <span className="text-gray-400 mb-2 text-2xl">📁</span>
                                                    <p className="mb-2 text-sm text-gray-500">
                                                        <span className="font-semibold">点击上传</span> 或拖放文件 (支持多选)
                                                    </p>
                                                    <p className="text-xs text-gray-500">支持图片 (JPG, PNG, GIF) 或视频 (MP4, MOV)</p>
                                                </div>
                                                <input
                                                    type="file"
                                                    className="hidden"
                                                    accept="image/*,video/*"
                                                    multiple
                                                    onChange={handleFileChange}
                                                />
                                            </label>
                                        </div>
                                        {selectedFiles.length > 0 && (
                                            <div className="mt-2">
                                                <div className="flex justify-between items-center mb-2">
                                                    <p className="text-sm text-gray-600">已选择 {selectedFiles.length} 个文件</p>
                                                    <button
                                                        onClick={() => setSelectedFiles([])}
                                                        className="text-red-500 hover:text-red-600 transition-colors"
                                                    >
                                                        清空全部
                                                    </button>
                                                </div>
                                                <div className="grid grid-cols-2 gap-2 max-h-48 overflow-y-auto">
                                                    {selectedFiles.map((file, index) => (
                                                        <div key={index} className="relative">
                                                            <button
                                                                onClick={() => removeSelectedFile(index)}
                                                                className="absolute top-1 right-1 z-10 bg-blue-500 text-white rounded-full p-1 hover:bg-blue-600 transition-colors"
                                                            >
                                                                <XCircle />
                                                            </button>
                                                            {file.type.startsWith('image/') ? (
                                                                <img
                                                                    src={URL.createObjectURL(file)}
                                                                    alt={`预览 ${index + 1}`}
                                                                    className="w-full h-20 object-cover rounded-md"
                                                                />
                                                            ) : (
                                                                <video
                                                                    src={URL.createObjectURL(file)}
                                                                    className="w-full h-20 object-cover rounded-md"
                                                                >
                                                                    您的浏览器不支持视频标签。
                                                                </video>
                                                            )}
                                                            <p className="text-xs text-gray-600 mt-1 truncate">{file.name}</p>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <div className="mb-4">
                                        <label className="block text-gray-700 text-sm font-medium mb-2">
                                            发布平台
                                        </label>
                                        <div className="grid grid-cols-3 gap-2">
                                            {platforms.map(platform => (
                                                <button
                                                    key={platform.name}
                                                    onClick={() => togglePlatform(platform.name)}
                                                    className={`px-3 py-2 text-sm rounded-md transition-colors ${
                                                        selectedPlatforms.includes(platform.name)
                                                            ? 'bg-blue-500 text-white'
                                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                                    }`}
                                                >
                                                    {platform.name}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="mb-6">
                                        <label className="block text-gray-700 text-sm font-medium mb-2">
                                            文案内容 (可选)
                                        </label>
                                        <textarea
                                            value={captionInput}
                                            onChange={(e) => setCaptionInput(e.target.value)}
                                            placeholder="输入你的文案内容..."
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
                                            rows="4"
                                        ></textarea>
                                    </div>

                                    <div className="flex space-x-3">
                                        <button
                                            onClick={closeModal}
                                            className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50 transition-colors"
                                        >
                                            取消
                                        </button>
                                        <button
                                            onClick={addMediaToDay}
                                            className="flex-1 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"
                                        >
                                            保存
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Lightbox模态框 */}
                        {lightboxMedia && (
                            <div 
                                className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4"
                                onClick={closeLightbox}
                            >
                                <div className="flex max-w-7xl max-h-full w-full gap-6" onClick={(e) => e.stopPropagation()}>
                                    <button
                                        onClick={closeLightbox}
                                        className="absolute top-6 right-6 z-60 bg-white bg-opacity-20 text-white rounded-full p-2 hover:bg-opacity-30 transition-colors"
                                    >
                                        <XCircle />
                                    </button>
                                    
                                    {/* 媒体内容区域 */}
                                    <div className="flex-1 flex items-center justify-center relative">
                                        {/* 多文件时的左右切换按钮 */}
                                        {lightboxMedia.allFiles && lightboxMedia.allFiles.length > 1 && (
                                            <>
                                                <button
                                                    onClick={() => {
                                                        const allFiles = lightboxMedia.allFiles;
                                                        const newIndex = (currentLightboxIndex - 1 + allFiles.length) % allFiles.length;
                                                        setCurrentLightboxIndex(newIndex);
                                                    }}
                                                    className="absolute left-4 z-50 bg-white bg-opacity-20 text-white rounded-full p-3 hover:bg-opacity-30 transition-colors"
                                                >
                                                    <ChevronLeft />
                                                </button>
                                                <button
                                                    onClick={() => {
                                                        const allFiles = lightboxMedia.allFiles;
                                                        const newIndex = (currentLightboxIndex + 1) % allFiles.length;
                                                        setCurrentLightboxIndex(newIndex);
                                                    }}
                                                    className="absolute right-4 z-50 bg-white bg-opacity-20 text-white rounded-full p-3 hover:bg-opacity-30 transition-colors"
                                                >
                                                    <ChevronRight />
                                                </button>
                                            </>
                                        )}

                                        {/* 媒体显示区域 */}
                                        {(() => {
                                            const currentMedia = lightboxMedia.allFiles ? 
                                                lightboxMedia.allFiles[currentLightboxIndex] : 
                                                lightboxMedia;
                                            
                                            if (currentMedia.type === 'image') {
                                                return (
                                                    <img
                                                        src={currentMedia.originalDataUrl || currentMedia.dataUrl}
                                                        alt={currentMedia.name}
                                                        className="max-w-full max-h-full object-contain rounded-lg"
                                                    />
                                                );
                                            } else if (currentMedia.type === 'video') {
                                                return (
                                                    <video
                                                        src={currentMedia.originalDataUrl || currentMedia.dataUrl}
                                                        controls
                                                        autoPlay
                                                        className="max-w-full max-h-full object-contain rounded-lg"
                                                    >
                                                        您的浏览器不支持视频标签。
                                                    </video>
                                                );
                                            } else {
                                                return (
                                                    <div className="flex items-center justify-center text-gray-400 text-xl">
                                                        📝 文字内容
                                                    </div>
                                                );
                                            }
                                        })()}

                                        {/* 轮播指示器 */}
                                        {lightboxMedia.allFiles && lightboxMedia.allFiles.length > 1 && (
                                            <div className="absolute bottom-6 left-1/2 transform -translate-x-1/2 flex space-x-2">
                                                {lightboxMedia.allFiles.map((_, index) => (
                                                    <button
                                                        key={index}
                                                        onClick={() => setCurrentLightboxIndex(index)}
                                                        className={`w-3 h-3 rounded-full transition-colors ${
                                                            index === currentLightboxIndex 
                                                                ? 'bg-white' 
                                                                : 'bg-white bg-opacity-50 hover:bg-opacity-75'
                                                        }`}
                                                    />
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                    
                                    {/* 右侧文字内容区域 */}
                                    <div className="w-80 bg-white rounded-lg p-6 flex flex-col max-h-full">
                                        <div className="flex items-center justify-between mb-4">
                                            <h3 className="text-lg font-semibold text-gray-800">文案内容</h3>
                                            <button
                                                onClick={async () => {
                                                    try {
                                                        await navigator.clipboard.writeText(lightboxMedia.caption || '');
                                                        showTemporaryMessage('文案已复制到剪贴板', 'success');
                                                    } catch (err) {
                                                        showTemporaryMessage('复制失败，请手动复制', 'error');
                                                    }
                                                }}
                                                className="px-3 py-1 bg-blue-500 text-white text-sm rounded-md hover:bg-blue-600 transition-colors"
                                            >
                                                📋 复制
                                            </button>
                                        </div>
                                        
                                        <div className="flex-1 overflow-y-auto border rounded-md p-4 bg-gray-50 mb-4">
                                            <p className="text-gray-700 leading-relaxed whitespace-pre-wrap">
                                                {lightboxMedia.caption || '暂无文案内容'}
                                            </p>
                                        </div>

                                        <div className="border-t pt-4">
                                            <h4 className="text-sm font-medium text-gray-800 mb-2">
                                                文件信息 {lightboxMedia.allFiles ? `(${currentLightboxIndex + 1}/${lightboxMedia.allFiles.length})` : '(1/1)'}
                                            </h4>
                                            <div className="text-xs text-gray-600 space-y-1">
                                                {(() => {
                                                    const currentMedia = lightboxMedia.allFiles ? 
                                                        lightboxMedia.allFiles[currentLightboxIndex] : 
                                                        lightboxMedia;
                                                    return (
                                                        <>
                                                            <div>文件名: {currentMedia.name || '未知'}</div>
                                                            <div>类型: {currentMedia.type === 'image' ? '图片' : currentMedia.type === 'video' ? '视频' : '文本'}</div>
                                                            {currentMedia.size && (
                                                                <div>大小: {(currentMedia.size / 1024 / 1024).toFixed(2)} MB</div>
                                                            )}
                                                        </>
                                                    );
                                                })()}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>